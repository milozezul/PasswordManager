@using PManagerFrontend.Interfaces.Services
@inject IDataService _data

<div class="flex flex-row items-center gap-x-5 px-5 py-2">
    <div class="w-1"></div>
    <img src="icons/group.svg" class="w-6 h-6" />
    <div class="flex flex-col relative">
        <InputText type="text" class="bg-gray-300 text-gray-700 rounded-sm pl-2" @onkeydown="OnEnter" @bind-Value="GroupName" />
        <div class="absolute text-red-300 text-[10px] bottom-[-13px]">Must be within 100 characters</div>
        <div class="absolute top-0 right-2 h-full flex flex-row justify-end items-center">
            <img src="icons/cancel.svg" class="w-4 h-4" />
        </div>
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public EventCallback CloseNewGroup { get; set; }

    string GroupName { get; set; }

    async Task OnEnter(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            await CreateNewGroup();
        }
    }

    async Task CreateNewGroup()
    {
        await _data.CreateNewCategory(GroupName);
        GroupName = "";
        await CloseNewGroup.InvokeAsync();
    }
}
